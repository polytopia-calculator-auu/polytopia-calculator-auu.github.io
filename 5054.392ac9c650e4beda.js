"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5054],{5054:(ge,S,u)=>{u.r(S),u.d(S,{BattleCalculatorPageModule:()=>pe});var m=u(6895),c=u(4719),r=u(5056),T=u(5861),t=u(6353),M=u(5529),q=u(6498),F=u(1059),G=u(3489),$=u(6014);function B(n,a=$.P){return e=>e.lift(new V(n,a))}class V{constructor(a,e){this.dueTime=a,this.scheduler=e}call(a,e){return e.subscribe(new j(a,this.dueTime,this.scheduler))}}class j extends G.L{constructor(a,e,o){super(a),this.dueTime=e,this.scheduler=o,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(a){this.clearDebounce(),this.lastValue=a,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(W,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:a}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(a)}}clearDebounce(){const a=this.debouncedSubscription;null!==a&&(this.remove(a),a.unsubscribe(),this.debouncedSubscription=null)}}function W(n){n.debouncedNext()}var D=u(1177);function k(n){return a=>a.lift(new L(n))}class L{constructor(a){this.notifier=a}call(a,e){const o=new K(a),i=(0,D.ft)(this.notifier,new D.IY(o));return i&&!o.seenValue?(o.add(i),e.subscribe(o)):o}}class K extends D.Ds{constructor(a){super(a),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}var X=u(2994),N=u(7545),_=u(6959),d=u(7575);function w(n){const a=n.get("unit").value;return d.Qz.includes(a)&&!n.get("carriedUnit").value?{required:!0,name:"carriedUnit"}:null}var A=u(724);function y(n){const a=(0,A.n)(n.value);if(n.get("hp").value<=a)return null;const o={max:!0};return n.get("hp").setErrors(o),o}var I=u(8712),x=(()=>{return(n=x||(x={})).ATTACKER="attacker",n.DEFENDER="defender",x;var n})();let z=(()=>{class n{emitEvent(e,o,i=null,s,l=null){gtag("event",e,{event_category:o,event_label:i,event_params:s,event_value:l})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var tt=u(6787);const et=["hpInputComponent"],nt=["countInputComponent"];function ot(n,a){if(1&n&&t._UZ(0,"ion-img",13),2&n){const e=t.oxw();t.hYB("src","/assets/",e.unitFormType,"_units/",e.selectedUnit,".png")}}function it(n,a){if(1&n&&(t.TgZ(0,"ion-select-option",14),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function at(n,a){if(1&n&&t._UZ(0,"ion-img",13),2&n){const e=t.oxw(2);t.hYB("src","/assets/",e.unitFormType,"_units/",e.selectedCarriedUnit,".png")}}function st(n,a){if(1&n&&(t.TgZ(0,"ion-select-option",14),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}const J=function(n){return{header:"Select Unit",cssClass:n}};function rt(n,a){if(1&n&&(t.TgZ(0,"ion-item",1)(1,"ion-label"),t._uU(2," Carried Unit "),t.qZA(),t.YNc(3,at,1,2,"ion-img",2),t.TgZ(4,"ion-select",15),t.YNc(5,st,2,2,"ion-select-option",4),t.qZA()()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.selectedCarriedUnit),t.xp6(1),t.Q6J("interfaceOptions",t.VKq(3,J,e.unitFormType+"-carried-unit-option")),t.xp6(1),t.Q6J("ngForOf",e.carriedUnitOptions)}}function ct(n,a){1&n&&(t.TgZ(0,"ion-item",1)(1,"ion-label"),t._uU(2,"Is veteran?"),t.qZA(),t._UZ(3,"ion-checkbox",16),t.qZA())}function lt(n,a){if(1&n&&(t.TgZ(0,"ion-note",17),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij("(Max: ",e.maxHp,")")}}function ut(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"ion-item",1)(1,"ion-label"),t._uU(2,"Spawn count"),t.qZA(),t.TgZ(3,"div",7)(4,"ion-icon",18),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.decreaseSpawnCount())}),t.qZA(),t._UZ(5,"ion-ripple-effect"),t.qZA(),t.TgZ(6,"ion-input",19,20),t.NdJ("ionFocus",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.selectText(i))})("contextmenu",function(i){return i.preventDefault()}),t.qZA(),t.TgZ(8,"div",7)(9,"ion-icon",21),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.increaseSpawnCount())}),t.qZA(),t._UZ(10,"ion-ripple-effect"),t.qZA()()}}function dt(n,a){1&n&&(t.TgZ(0,"ion-item",1)(1,"ion-label"),t._uU(2,"Free from retaliation?"),t.qZA(),t._UZ(3,"ion-checkbox",22),t.qZA())}function pt(n,a){1&n&&(t.TgZ(0,"ion-item",1)(1,"ion-label"),t._uU(2,"Is boosted?"),t.qZA(),t._UZ(3,"ion-checkbox",23),t.qZA())}function gt(n,a){1&n&&(t.TgZ(0,"ion-item",1)(1,"ion-label"),t._uU(2,"Is poisoned?"),t.qZA(),t._UZ(3,"ion-checkbox",24),t.qZA())}function ht(n,a){1&n&&(t.TgZ(0,"ion-item",1)(1,"ion-label"),t._uU(2,"1.5 \xd7 Def bonus "),t.TgZ(3,"ion-note"),t._uU(4,"(City/Forest/Mountain/Ocean)"),t.qZA()(),t._UZ(5,"ion-radio",26),t.qZA())}function mt(n,a){1&n&&(t.TgZ(0,"ion-item",1)(1,"ion-label"),t._uU(2,"4 \xd7 Def bonus "),t.TgZ(3,"ion-note"),t._uU(4,"(City Wall)"),t.qZA()(),t._UZ(5,"ion-radio",27),t.qZA())}function ft(n,a){if(1&n&&(t.TgZ(0,"ion-radio-group",25),t.YNc(1,ht,6,0,"ion-item",5),t.YNc(2,mt,6,0,"ion-item",5),t.qZA()),2&n){const e=t.oxw();t.Q6J("allowEmptySelection",!0),t.xp6(1),t.Q6J("ngIf",e.hasDefenseBonus),t.xp6(1),t.Q6J("ngIf",e.hasWallDefenseBonus)}}let H=(()=>{class n{constructor(e){this.controlContainer=e,this.carriedUnitOptions=d.s2,this.onDestroy$=new M.xQ}ngOnInit(){const e=this.unitFormType===x.ATTACKER;this.unitOptions=e?d.in:d.ac,this.form=this.controlContainer.control,this.setMaxHp();const o=this.form.get("hp");this.form.get("isVeteran").valueChanges.pipe(k(this.onDestroy$)).subscribe(()=>{this.setMaxHp(),(o.pristine||!o.valid)&&this.form.get("hp").reset(this.maxHp)}),(0,tt.T)(this.form.get("unit").valueChanges,this.form.get("carriedUnit").valueChanges).pipe(k(this.onDestroy$)).subscribe(()=>{this.setMaxHp(),o.reset(this.maxHp,{emitEvent:!1}),this.isDefenderForm?this.form.get("isPoisoned").reset(!1,{emitEvent:!1}):this.form.get("isBoosted").reset(!1,{emitEvent:!1}),this.form.get("isVeteran")&&this.form.get("isVeteran").reset(!1,{emitEvent:!1}),this.form.get("withDefenseBonus")&&this.form.get("withDefenseBonus").reset(!1,{emitEvent:!1}),this.form.get("withWallBonus")&&this.form.get("withWallBonus").reset(!1,{emitEvent:!1}),this.form.updateValueAndValidity()}),e&&this.form.get("unit").valueChanges.pipe(k(this.onDestroy$)).subscribe(i=>{d.e6.includes(i)?this.form.get("freeFromRetaliation").setValue(!0):this.form.get("freeFromRetaliation").setValue(!1)})}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}get selectedUnit(){return this.form.get("unit").value}get selectedCarriedUnit(){return this.form.get("carriedUnit").value}get hasVeterance(){if(this.hasCarrySkill){const e=this.form.get("carriedUnit").value;return _.Z[e].veteranHp}return _.Z[this.selectedUnit].veteranHp}get isPoisoned(){return this.form.get("isPoisoned").value}get hasDefenseBonus(){return _.Z[this.selectedUnit].defenseBonus}get hasWallDefenseBonus(){return _.Z[this.selectedUnit].wallBonus}get hasCarrySkill(){return d.Qz.includes(this.selectedUnit)}get isLongRangeUnit(){return d.e6.includes(this.selectedUnit)}get isDefenderForm(){return this.unitFormType===x.DEFENDER}setMaxHp(){this.maxHp=(0,A.n)(this.form.getRawValue())}decreaseHp(){const e=this.form.get("hp"),o=e.value||0;o>0&&(e.setValue(parseInt(o,10)-1),e.updateValueAndValidity())}increaseHp(){const e=this.form.get("hp");e.setValue(parseInt(e.value||0,10)+1),e.updateValueAndValidity()}decreaseSpawnCount(){const e=this.form.get("spawnCount"),o=e.value||0;o>0&&(e.setValue(parseInt(o,10)-1),e.updateValueAndValidity())}increaseSpawnCount(){const e=this.form.get("spawnCount");e.setValue(parseInt(e.value||0,10)+1),e.updateValueAndValidity()}selectText(e){return(0,T.Z)(function*(){(yield e.target.getInputElement()).select()})()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.gN))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-unit-form"]],viewQuery:function(e,o){if(1&e&&(t.Gf(et,7),t.Gf(nt,5)),2&e){let i;t.iGM(i=t.CRH())&&(o.hpInputComponent=i.first),t.iGM(i=t.CRH())&&(o.countInputComponent=i.first)}},inputs:{unitFormType:"unitFormType",multi:"multi"},decls:26,vars:14,consts:[[3,"formGroup"],["tappable",""],["class","unit-image",3,"src",4,"ngIf"],["tappable","","formControlName","unit","interface","action-sheet",3,"interfaceOptions"],[3,"value",4,"ngFor","ngForOf"],["tappable","",4,"ngIf"],["inputmode","numeric",4,"ngIf"],["slot","end",1,"range-arrows-container","ion-activatable","ripple-parent"],["tappable","","slot","end","src","/assets/chevron-back-outline.svg",1,"input-hp-arrow",3,"click"],["slot","end","tappable","","type","text","formControlName","hp","inputmode","numeric","enterkeyhint","done","pattern","^([0-9])+$",1,"input-hp",3,"ionFocus","contextmenu"],["hpInputComponent",""],["tappable","","src","/assets/chevron-forward-outline.svg",1,"input-hp-arrow",3,"click"],["formControlName","withDefenseBonus",3,"allowEmptySelection",4,"ngIf"],[1,"unit-image",3,"src"],[3,"value"],["tappable","","formControlName","carriedUnit","interface","action-sheet",3,"interfaceOptions"],["tappable","","slot","end","formControlName","isVeteran"],["inputmode","numeric"],["tappable","","slot","end","src","/assets/chevron-back-outline.svg",1,"input-count-arrow",3,"click"],["tappable","","slot","end","type","text","formControlName","spawnCount","inputmode","numeric","enterkeyhint","done","pattern","^([0-9])+$",1,"input-count",3,"ionFocus","contextmenu"],["countInputComponent",""],["tappable","","slot","end","src","/assets/chevron-forward-outline.svg",1,"input-count-arrow",3,"click"],["tappable","","slot","end","formControlName","freeFromRetaliation"],["tappable","","slot","end","formControlName","isBoosted"],["tappable","","slot","end","formControlName","isPoisoned"],["formControlName","withDefenseBonus",3,"allowEmptySelection"],["tappable","","slot","end","value","withoutWall"],["tappable","","slot","end","value","withWall"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-item-group",0)(1,"ion-item",1)(2,"ion-label"),t._uU(3," Unit "),t.qZA(),t.YNc(4,ot,1,2,"ion-img",2),t.TgZ(5,"ion-select",3),t.YNc(6,it,2,2,"ion-select-option",4),t.qZA()(),t.YNc(7,rt,6,5,"ion-item",5),t.YNc(8,ct,4,0,"ion-item",5),t.TgZ(9,"ion-item",1)(10,"ion-label"),t._uU(11,"HP "),t.YNc(12,lt,2,1,"ion-note",6),t.qZA(),t.TgZ(13,"div",7)(14,"ion-icon",8),t.NdJ("click",function(){return o.decreaseHp()}),t.qZA(),t._UZ(15,"ion-ripple-effect"),t.qZA(),t.TgZ(16,"ion-input",9,10),t.NdJ("ionFocus",function(s){return o.selectText(s)})("contextmenu",function(s){return s.preventDefault()}),t.qZA(),t.TgZ(18,"div",7)(19,"ion-icon",11),t.NdJ("click",function(){return o.increaseHp()}),t.qZA(),t._UZ(20,"ion-ripple-effect"),t.qZA()(),t.YNc(21,ut,11,0,"ion-item",5),t.YNc(22,dt,4,0,"ion-item",5),t.YNc(23,pt,4,0,"ion-item",5),t.YNc(24,gt,4,0,"ion-item",5),t.YNc(25,ft,3,3,"ion-radio-group",12),t.qZA()),2&e&&(t.Q6J("formGroup",o.form),t.xp6(4),t.Q6J("ngIf",o.selectedUnit),t.xp6(1),t.Q6J("interfaceOptions",t.VKq(12,J,o.unitFormType+"-unit-option")),t.xp6(1),t.Q6J("ngForOf",o.unitOptions),t.xp6(1),t.Q6J("ngIf",o.hasCarrySkill),t.xp6(1),t.Q6J("ngIf",o.hasVeterance),t.xp6(4),t.Q6J("ngIf",o.maxHp),t.xp6(9),t.Q6J("ngIf",o.multi),t.xp6(1),t.Q6J("ngIf",o.isLongRangeUnit&&!o.isDefenderForm),t.xp6(1),t.Q6J("ngIf",!o.isDefenderForm),t.xp6(1),t.Q6J("ngIf",o.isDefenderForm),t.xp6(1),t.Q6J("ngIf",o.isDefenderForm&&!o.isPoisoned))},dependencies:[m.sg,m.O5,r.nz,r.gu,r.Xz,r.pK,r.Ie,r.Ub,r.Q$,r.uN,r.B7,r.se,r.H$,r.t9,r.n0,r.w,r.U5,r.QI,r.j9,c.JJ,c.JL,c.c5,c.sg,c.u],styles:['.input-hp[_ngcontent-%COMP%], .input-count[_ngcontent-%COMP%]{text-align:center;width:30px;display:block;margin-left:0;flex:initial;margin-right:10px}.input-hp-arrow[_ngcontent-%COMP%], .input-count-arrow[_ngcontent-%COMP%]{cursor:pointer}.unit-image[_ngcontent-%COMP%]{width:35px;height:35px;margin-top:5px;margin-bottom:5px;margin-left:10px}.range-arrows-container[_ngcontent-%COMP%]{margin-left:0;display:inline-flex;font-size:30px;padding-inline:8px;padding-block:6px}  .defender-unit-option .action-sheet-button .action-sheet-button-inner:before,   .defender-carried-unit-option .action-sheet-button .action-sheet-button-inner:before,   .attacker-unit-option .action-sheet-button .action-sheet-button-inner:before,   .attacker-carried-unit-option .action-sheet-button .action-sheet-button-inner:before{display:block;width:40px;height:40px;margin-right:15px}  .defender-unit-option .action-sheet-button:nth-child(2) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Warrior.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(3) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Rider.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(4) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Defender.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(5) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Swordsman.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(6) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Archer.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(7) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Catapult.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(8) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Knight.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(9) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Giant.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(10) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Boat.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(11) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Ship.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(12) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Battleship.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(13) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Mind\\ Bender.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(14) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Amphibian.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(15) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Crab.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(16) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Tridention.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(17) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Polytaur.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(18) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Navalon.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(19) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Dragon\\ Egg.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(20) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Baby\\ Dragon.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(21) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Fire\\ Dragon.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(22) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Mooni.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(23) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Ice\\ Archer.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(24) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Battle\\ Sled.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(25) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Ice\\ Fortress.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(26) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Gaami.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(27) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Shaman.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(28) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Hexapod.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(29) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Phychi.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(30) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Raychi.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(31) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Kiton.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(32) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Doomux.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(33) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Exida.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(34) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Centipede.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(35) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Segment.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(36) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Nature\\ Bunny.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(37) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Dagger.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(38) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Cloak.png);background-size:100% 100%}  .defender-unit-option .action-sheet-button:nth-child(39) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Dinghy.png);background-size:100% 100%}  .defender-carried-unit-option .action-sheet-button:nth-child(2) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Warrior.png);background-size:100% 100%}  .defender-carried-unit-option .action-sheet-button:nth-child(3) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Rider.png);background-size:100% 100%}  .defender-carried-unit-option .action-sheet-button:nth-child(4) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Defender.png);background-size:100% 100%}  .defender-carried-unit-option .action-sheet-button:nth-child(5) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Swordsman.png);background-size:100% 100%}  .defender-carried-unit-option .action-sheet-button:nth-child(6) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Archer.png);background-size:100% 100%}  .defender-carried-unit-option .action-sheet-button:nth-child(7) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Catapult.png);background-size:100% 100%}  .defender-carried-unit-option .action-sheet-button:nth-child(8) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Mind\\ Bender.png);background-size:100% 100%}  .defender-carried-unit-option .action-sheet-button:nth-child(9) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Knight.png);background-size:100% 100%}  .defender-carried-unit-option .action-sheet-button:nth-child(10) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Giant.png);background-size:100% 100%}  .defender-carried-unit-option .action-sheet-button:nth-child(11) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Polytaur.png);background-size:100% 100%}  .defender-carried-unit-option .action-sheet-button:nth-child(12) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Nature\\ Bunny.png);background-size:100% 100%}  .defender-carried-unit-option .action-sheet-button:nth-child(13) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Cloak.png);background-size:100% 100%}  .defender-carried-unit-option .action-sheet-button:nth-child(14) .action-sheet-button-inner:before{content:"";background:url(/assets/defender_units/Dagger.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(2) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Warrior.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(3) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Rider.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(4) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Defender.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(5) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Swordsman.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(6) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Archer.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(7) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Catapult.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(8) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Knight.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(9) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Giant.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(10) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Boat.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(11) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Ship.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(12) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Battleship.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(13) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Amphibian.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(14) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Crab.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(15) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Tridention.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(16) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Polytaur.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(17) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Navalon.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(18) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Baby\\ Dragon.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(19) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Fire\\ Dragon.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(20) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Ice\\ Archer.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(21) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Battle\\ Sled.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(22) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Ice\\ Fortress.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(23) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Gaami.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(24) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Shaman.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(25) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Hexapod.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(26) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Phychi.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(27) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Raychi.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(28) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Kiton.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(29) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Doomux.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(30) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Exida.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(31) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Centipede.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(32) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Segment.png);background-size:100% 100%}  .attacker-unit-option .action-sheet-button:nth-child(33) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Dagger.png);background-size:100% 100%}  .attacker-carried-unit-option .action-sheet-button:nth-child(2) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Warrior.png);background-size:100% 100%}  .attacker-carried-unit-option .action-sheet-button:nth-child(3) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Rider.png);background-size:100% 100%}  .attacker-carried-unit-option .action-sheet-button:nth-child(4) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Defender.png);background-size:100% 100%}  .attacker-carried-unit-option .action-sheet-button:nth-child(5) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Swordsman.png);background-size:100% 100%}  .attacker-carried-unit-option .action-sheet-button:nth-child(6) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Archer.png);background-size:100% 100%}  .attacker-carried-unit-option .action-sheet-button:nth-child(7) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Catapult.png);background-size:100% 100%}  .attacker-carried-unit-option .action-sheet-button:nth-child(8) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Mind\\ Bender.png);background-size:100% 100%}  .attacker-carried-unit-option .action-sheet-button:nth-child(9) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Knight.png);background-size:100% 100%}  .attacker-carried-unit-option .action-sheet-button:nth-child(10) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Giant.png);background-size:100% 100%}  .attacker-carried-unit-option .action-sheet-button:nth-child(11) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Polytaur.png);background-size:100% 100%}  .attacker-carried-unit-option .action-sheet-button:nth-child(12) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Nature\\ Bunny.png);background-size:100% 100%}  .attacker-carried-unit-option .action-sheet-button:nth-child(13) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Cloak.png);background-size:100% 100%}  .attacker-carried-unit-option .action-sheet-button:nth-child(14) .action-sheet-button-inner:before{content:"";background:url(/assets/attacker_units/Dagger.png);background-size:100% 100%}']}),n})();function bt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"ion-item")(1,"div",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index,s=t.oxw();return t.KtG(s.moveUp("attacker",i))}),t._uU(2," Move up "),t._UZ(3,"ion-icon",14),t.qZA(),t.TgZ(4,"div",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index,s=t.oxw();return t.KtG(s.moveDown("attacker",i))}),t._uU(5," Move down "),t._UZ(6,"ion-icon",15),t.qZA()()}if(2&n){const e=t.oxw(),o=e.first,i=e.last;t.xp6(1),t.ekj("disabled",o),t.xp6(3),t.ekj("disabled",i)}}function _t(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"ion-item",16),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index,s=t.oxw();return t.KtG(s.removeOffenseUnit(i))}),t._UZ(1,"ion-icon",17),t.qZA()}}function kt(n,a){1&n&&t._UZ(0,"ion-item-divider")}function xt(n,a){if(1&n&&(t.ynx(0,9),t._UZ(1,"app-unit-form",10),t.YNc(2,bt,7,4,"ion-item",11),t.YNc(3,_t,2,0,"ion-item",12),t.YNc(4,kt,1,0,"ion-item-divider",11),t.BQk()),2&n){const e=a.index,o=a.last,i=t.oxw();t.xp6(1),t.Q6J("formGroupName",e)("multi",!0),t.xp6(1),t.Q6J("ngIf",i.attackerForms.length>1&&!i.battleForm.get("getOptimalResult").value),t.xp6(1),t.Q6J("ngIf",i.attackerForms.length>1),t.xp6(1),t.Q6J("ngIf",!o)}}function Ct(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"ion-item")(1,"div",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index,s=t.oxw();return t.KtG(s.moveUp("defender",i))}),t._uU(2," Move up "),t._UZ(3,"ion-icon",14),t.qZA(),t.TgZ(4,"div",13),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index,s=t.oxw();return t.KtG(s.moveDown("defender",i))}),t._uU(5," Move down "),t._UZ(6,"ion-icon",15),t.qZA()()}if(2&n){const e=t.oxw(),o=e.first,i=e.last;t.xp6(1),t.ekj("disabled",o),t.xp6(3),t.ekj("disabled",i)}}function Zt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"ion-item",16),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index,s=t.oxw();return t.KtG(s.removeDefenseUnit(i))}),t._UZ(1,"ion-icon",20),t.qZA()}}function vt(n,a){1&n&&t._UZ(0,"ion-item-divider")}function Ut(n,a){if(1&n&&(t.ynx(0,18),t._UZ(1,"app-unit-form",19),t.YNc(2,Ct,7,4,"ion-item",11),t.YNc(3,Zt,2,0,"ion-item",12),t.YNc(4,vt,1,0,"ion-item-divider",11),t.BQk()),2&n){const e=a.index,o=a.last,i=t.oxw();t.xp6(1),t.Q6J("formGroupName",e)("multi",!0),t.xp6(1),t.Q6J("ngIf",i.defenderForms.length>1&&!i.battleForm.get("getOptimalResult").value),t.xp6(1),t.Q6J("ngIf",i.defenderForms.length>1),t.xp6(1),t.Q6J("ngIf",!o)}}let Ot=(()=>{class n{constructor(e,o,i){this.fb=e,this.cdr=o,this.googleAnalytics=i,this.attackerUnits=d.in,this.defenderUnits=d.ac,this.landUnits=d.s2,this.resultChange=new t.vpe,this.onDestroy$=new M.xQ,this.battleForm=this.fb.group({attackers:e.array([this.createAttackerForm()]),defenders:e.array([this.createDefenderForm()]),getOptimalResult:!1}),this.battleForm.valueChanges.pipe((0,F.O)(this.battleForm.value),B(300),k(this.onDestroy$),(0,X.b)(()=>{this.isExecutingBattleMatches=!0}),(0,N.w)(()=>this.showBattleResults())).subscribe(({battleResults:s=[],battleResultStatistics:l,isInvalid:g})=>{this.battleResults=s,this.battleResultStatistics=l;const p=this.battleForm.get("getOptimalResult").value;this.resultChange.emit({battleResults:s,battleResultStatistics:l,showingOptimalResult:p,isInvalid:g}),this.isExecutingBattleMatches=!1,this.cdr.detectChanges()})}get attackerForms(){return this.battleForm.get("attackers").controls}get defenderForms(){return this.battleForm.get("defenders").controls}createAttackerForm(){const e=this.attackerUnits[0];return this.fb.group({unit:e,carriedUnit:this.landUnits[0],hp:[_.Z[e].hp,[c.kI.required,c.kI.min(0)]],isVeteran:!1,freeFromRetaliation:!1,isBoosted:!1,spawnCount:[1,c.kI.min(1)]},{validators:[y,w]})}createDefenderForm(){const e=this.defenderUnits[0];return this.fb.group({unit:e,carriedUnit:this.landUnits[0],hp:[_.Z[e].hp,[c.kI.required,c.kI.min(0)]],isVeteran:!1,withDefenseBonus:!1,withWallBonus:!1,isPoisoned:!1,spawnCount:[1,c.kI.min(1)]},{validators:[y,w]})}addOffenseUnit(){this.battleForm.get("attackers").push(this.createAttackerForm())}addDefenseUnit(){this.battleForm.get("defenders").push(this.createDefenderForm())}removeOffenseUnit(e){this.battleForm.get("attackers").removeAt(e)}removeDefenseUnit(e){this.battleForm.get("defenders").removeAt(e)}move(e,o,i){const l=this.battleForm.get(e===x.ATTACKER?"attackers":"defenders");let g=o+i;if(-1===g||g==l.length)return;const p=l.at(o);l.removeAt(o),l.insert(g,p)}moveUp(e,o){this.move(e,o,-1)}moveDown(e,o){this.move(e,o,1)}toggleGetOptimalResult(){const e=this.battleForm.get("getOptimalResult").value;this.battleForm.get("getOptimalResult").setValue(!e)}showBattleResults(){return new q.y(e=>{if(!this.battleForm.valid)return e.next({isInvalid:!0}),void e.complete();const o=this.getUnits("attackers"),i=this.getUnits("defenders");this.googleAnalytics.emitEvent("battle calculate","method",`${o.map(l=>l.unit).join(", ")} vs ${i.map(l=>l.unit).join(", ")}`,{attackers:o,defenders:i},1);const s=this.battleForm.get("getOptimalResult").value;if(typeof Worker<"u"){const l=new Worker(u.tu(new URL(u.p+u.u(4146),u.b)),{type:void 0});return l.onmessage=({data:g})=>{e.next(g),e.complete(),l.terminate()},l.postMessage({attackers:o,defenders:i,getOptimalResult:s}),{unsubscribe:()=>{e.complete(),l.terminate()}}}e.next((0,I.M_)(o,i,s)),e.complete()})}getUnits(e){const o=[];return this.battleForm.get(e).value.forEach(i=>{for(let s=0;s<i.spawnCount;s++)o.push({...i})}),o}ngOnInit(){}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.QS),t.Y36(t.sBO),t.Y36(z))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-battle"]],outputs:{resultChange:"resultChange"},decls:23,vars:3,consts:[[3,"formGroup"],[1,"two-column-wrapper"],["formArrayName","attackers",4,"ngFor","ngForOf"],["color","success",3,"click"],["src","/assets/add-circle-outline.svg",1,"add-icon"],["formArrayName","defenders",4,"ngFor","ngForOf"],[1,"optimal-result-block"],["formControlName","getOptimalResult"],[3,"click"],["formArrayName","attackers"],["unitFormType","attacker",3,"formGroupName","multi"],[4,"ngIf"],["color","danger",3,"click",4,"ngIf"],[1,"half-width",3,"click"],["name","arrow-up-circle-outline","size","medium"],["name","arrow-down-circle-outline","size","medium"],["color","danger",3,"click"],["name","trash-bin-outline",1,"delete-icon"],["formArrayName","defenders"],["unitFormType","defender",3,"formGroupName","multi"],["src","/assets/trash-bin-outline.svg",1,"delete-icon"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0)(1,"div",1)(2,"ion-list")(3,"ion-item-divider")(4,"ion-title"),t._uU(5,"Offense Units"),t.qZA()(),t.YNc(6,xt,5,5,"ng-container",2),t.TgZ(7,"ion-item",3),t.NdJ("click",function(){return o.addOffenseUnit()}),t._UZ(8,"ion-icon",4),t.qZA()(),t.TgZ(9,"ion-list")(10,"ion-item-divider")(11,"ion-title"),t._uU(12,"Defense Units"),t.qZA()(),t.YNc(13,Ut,5,5,"ng-container",5),t.TgZ(14,"ion-item",3),t.NdJ("click",function(){return o.addDefenseUnit()}),t._UZ(15,"ion-icon",4),t.qZA()()(),t.TgZ(16,"div",6),t._UZ(17,"ion-checkbox",7),t.TgZ(18,"ion-label",8),t.NdJ("click",function(){return o.toggleGetOptimalResult()}),t._uU(19,"Get most optimal result"),t.qZA(),t._UZ(20,"br"),t.TgZ(21,"ion-note"),t._uU(22,"Note: Uncheck this if battle execution takes too long due to high number of units, unchecking this will then execute the moves in the order units are entered."),t.qZA()()()),2&e&&(t.Q6J("formGroup",o.battleForm),t.xp6(6),t.Q6J("ngForOf",o.attackerForms),t.xp6(7),t.Q6J("ngForOf",o.defenderForms))},dependencies:[m.sg,m.O5,r.nz,r.gu,r.Ie,r.rH,r.Q$,r.q_,r.uN,r.wd,r.w,c._Y,c.JJ,c.JL,c.sg,c.u,c.x0,c.CE,H],styles:["[_nghost-%COMP%]{display:flex;width:100%;flex-direction:column}form[_ngcontent-%COMP%], .two-column-wrapper[_ngcontent-%COMP%]{width:100%}.delete-icon[_ngcontent-%COMP%], .add-icon[_ngcontent-%COMP%]{display:block;margin:auto}.half-width[_ngcontent-%COMP%]{width:50%;text-align:center;padding:10px}.half-width.disabled[_ngcontent-%COMP%]{opacity:.5}.half-width[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{vertical-align:middle;display:inline-block}.optimal-result-block[_ngcontent-%COMP%]{text-align:left;margin-top:20px}.optimal-result-block[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{vertical-align:middle;margin-left:6px;font-size:15px;text-indent:0;display:inline-block}.paypal-form[_ngcontent-%COMP%]{display:block}ion-list[_ngcontent-%COMP%]{padding:0;margin-top:20px}app-battle-result[_ngcontent-%COMP%]{flex:1;display:block;margin-top:30px;margin-bottom:20px}ion-title[_ngcontent-%COMP%]{color:var(--ion-text-color)}@media (min-width: 768px){.two-column-wrapper[_ngcontent-%COMP%]{display:flex;align-items:flex-start}ion-list[_ngcontent-%COMP%]{flex:1}ion-list[_ngcontent-%COMP%]:first-child{margin:20px 5px}}"]}),n})();function Tt(n,a){1&n&&(t.TgZ(0,"ion-text",10),t._uU(1,"Survived"),t.qZA())}function Mt(n,a){1&n&&(t.TgZ(0,"ion-text",6),t._uU(1,"Destroyed"),t.qZA())}function wt(n,a){if(1&n&&(t.ynx(0),t._UZ(1,"br"),t.TgZ(2,"ion-text"),t._uU(3),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(3),t.hij("",e.defender.splashedNewHp," (on splash damage)")}}function At(n,a){1&n&&(t.TgZ(0,"ion-text",10),t._uU(1,"Survived"),t.qZA())}function yt(n,a){1&n&&(t.TgZ(0,"ion-text",6),t._uU(1,"Destroyed"),t.qZA())}function Pt(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"tr")(2,"td",3),t._uU(3),t.qZA()(),t.TgZ(4,"tr")(5,"td"),t._uU(6),t.TgZ(7,"span"),t._uU(8,"(Offense)"),t.qZA(),t.TgZ(9,"ion-thumbnail",4),t._UZ(10,"img",5),t.qZA()(),t.TgZ(11,"td")(12,"ion-text"),t._uU(13),t.TgZ(14,"ion-note",6),t._uU(15),t.qZA()()(),t.TgZ(16,"td")(17,"ion-text"),t._uU(18),t.qZA()(),t.TgZ(19,"td"),t.YNc(20,Tt,2,0,"ion-text",7),t.YNc(21,Mt,2,0,"ion-text",8),t.qZA()(),t.TgZ(22,"tr")(23,"td"),t._uU(24),t.TgZ(25,"ion-thumbnail",4),t._UZ(26,"img",5),t.qZA()(),t.TgZ(27,"td")(28,"ion-text"),t._uU(29),t.TgZ(30,"ion-note",6),t._uU(31),t.qZA()()(),t.TgZ(32,"td")(33,"ion-text"),t._uU(34),t.qZA(),t.YNc(35,wt,4,1,"ng-container",9),t.qZA(),t.TgZ(36,"td"),t.YNc(37,At,2,0,"ion-text",7),t.YNc(38,yt,2,0,"ion-text",8),t.qZA()(),t.BQk()),2&n){const e=a.$implicit,o=a.index,i=t.oxw();t.xp6(3),t.AsE("",o+1,"",i.getOrderSuperscript(o)," move"),t.xp6(3),t.hij(" ",e.attacker.unit," "),t.xp6(4),t.MGl("src","assets/attacker_units/",e.attacker.unit,".png",t.LSH),t.xp6(3),t.hij("",e.attacker.origHp," "),t.xp6(2),t.Oqu(e.defender.defenseDamage>0?"(-"+e.defender.defenseDamage+")":""),t.xp6(3),t.Oqu(e.attacker.newHp),t.xp6(2),t.Q6J("ngIf",e.attacker.newHp>0),t.xp6(1),t.Q6J("ngIf",0===e.attacker.newHp),t.xp6(3),t.hij(" ",e.defender.unit," (Defense) "),t.xp6(2),t.MGl("src","assets/defender_units/",e.defender.unit,".png",t.LSH),t.xp6(3),t.hij("",e.defender.origHp," "),t.xp6(2),t.Oqu(e.attacker.attackDamage>0?"(-"+e.attacker.attackDamage+")":""),t.xp6(3),t.Oqu(e.defender.newHp),t.xp6(1),t.Q6J("ngIf",e.defender.splashedNewHp),t.xp6(2),t.Q6J("ngIf",e.defender.newHp>0),t.xp6(1),t.Q6J("ngIf",0===e.defender.newHp)}}let Ft=(()=>{class n{getAttacker(e){return this.battleResults[e].attacker}getDefender(e){return this.battleResults[e].defender}getAttackDamageColor(e){return this.assessColor(this.getAttacker(e).attackDamage,this.getDefender(e).defenseDamage)}getDefenseDamageColor(e){return this.assessColor(this.getDefender(e).defenseDamage,this.getAttacker(e).attackDamage)}assessColor(e,o){return e>o?"success":e<o?"danger":null}getOrderSuperscript(e){const o=e+1;return o>10&&o<20?"th":o%10==1?"st":o%10==2?"nd":o%10==3?"rd":"th"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-battle-result"]],inputs:{battleResults:"battleResults",battleResultStatistics:"battleResultStatistics",multi:"multi",showingOptimalResult:"showingOptimalResult"},decls:14,vars:1,consts:[[1,"table-title"],["scope",""],[4,"ngFor","ngForOf"],["colspan","4",1,"move-order-text"],[1,"unit-image"],[3,"src"],["color","danger"],["color","success",4,"ngIf"],["color","danger",4,"ngIf"],[4,"ngIf"],["color","success"]],template:function(e,o){1&e&&(t.TgZ(0,"span",0),t._uU(1,"Attack moves breakdown"),t.qZA(),t.TgZ(2,"table")(3,"thead")(4,"th",1),t._uU(5,"Unit"),t.qZA(),t.TgZ(6,"th",1),t._uU(7,"Original HP"),t.qZA(),t.TgZ(8,"th",1),t._uU(9,"New HP"),t.qZA(),t.TgZ(10,"th",1),t._uU(11,"Status"),t.qZA()(),t.TgZ(12,"tbody"),t.YNc(13,Pt,39,17,"ng-container",2),t.qZA()()),2&e&&(t.xp6(13),t.Q6J("ngForOf",o.battleResults))},dependencies:[m.sg,m.O5,r.uN,r.yW,r.Bs],styles:[".unit-image[_ngcontent-%COMP%]{width:35px;height:35px;display:inline-block;vertical-align:middle;margin-left:20px}.unit-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:contain;object-fit:contain}ion-card-content[_ngcontent-%COMP%]{font-size:15px}.move-order-text[_ngcontent-%COMP%]{text-align:center!important;font-weight:500}.summary-unit-block[_ngcontent-%COMP%]{display:inline-block;padding:10px;font-size:16px;font-weight:700;letter-spacing:1.2px}.summary-unit-block[_ngcontent-%COMP%]   .unit-image[_ngcontent-%COMP%]{margin-left:0}.table-title[_ngcontent-%COMP%]{font-size:16px;margin-top:5px;margin-bottom:10px;font-weight:500;display:block}.swords-icon[_ngcontent-%COMP%]{display:inline-block;width:25px;height:25px;vertical-align:top;margin:0 15px}table[_ngcontent-%COMP%]{border-spacing:0;width:100%;border-collapse:collapse;border:1px solid var(--ion-item-background)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid var(--ion-item-background);text-align:left;padding:5px 15px;font-size:15px;vertical-align:top}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:400;background:var(--ion-item-background)}@media (prefers-color-scheme: dark){table[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #565656}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#424242}}"]}),n})();function Bt(n,a){1&n&&(t.TgZ(0,"ion-text",7),t._UZ(1,"ion-icon",8),t._uU(2," Please fix invalid inputs.\n"),t.qZA())}function Dt(n,a){1&n&&(t.TgZ(0,"div",9),t._UZ(1,"ion-spinner",10)(2,"br"),t.TgZ(3,"span"),t._uU(4,"Executing battle matches"),t.qZA(),t._UZ(5,"br"),t.qZA())}function Rt(n,a){if(1&n&&(t.TgZ(0,"div",14)(1,"ion-thumbnail",15),t._UZ(2,"img",16),t.qZA(),t._uU(3),t.TgZ(4,"ion-text",17),t._uU(5),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.MGl("src","assets/attacker_units/",e.unit,".png",t.LSH),t.xp6(1),t.hij(" (",e.newHp,") "),t.xp6(2),t.Oqu(e.hp-e.newHp?"(-"+(e.hp-e.newHp)+")":"")}}function St(n,a){if(1&n&&(t.TgZ(0,"div",14)(1,"ion-thumbnail",15),t._UZ(2,"img",16),t.qZA(),t._uU(3),t.TgZ(4,"ion-text",17),t._uU(5),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.MGl("src","assets/attacker_units/",e.unit,".png",t.LSH),t.xp6(1),t.hij(" (",e.newHp,") "),t.xp6(2),t.hij("(-",e.origHp,")")}}function qt(n,a){if(1&n&&(t.TgZ(0,"div",14)(1,"ion-thumbnail",15),t._UZ(2,"img",16),t.qZA(),t._uU(3),t.TgZ(4,"ion-note"),t._uU(5,"(unused)"),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.MGl("src","assets/attacker_units/",e.unit,".png",t.LSH),t.xp6(1),t.hij(" (",e.hp,") ")}}function Nt(n,a){if(1&n&&(t.TgZ(0,"div",14)(1,"ion-thumbnail",15),t._UZ(2,"img",16),t.qZA(),t._uU(3),t.TgZ(4,"ion-text",17),t._uU(5),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.MGl("src","assets/defender_units/",e.unit,".png",t.LSH),t.xp6(1),t.hij(" (",e.newHp,") "),t.xp6(2),t.Oqu((e.preservedHp||e.origHp)-e.newHp?"(-"+((e.preservedHp||e.origHp)-e.newHp)+")":"")}}function It(n,a){if(1&n&&(t.TgZ(0,"div",14)(1,"ion-thumbnail",15),t._UZ(2,"img",16),t.qZA(),t._uU(3),t.TgZ(4,"ion-text",17),t._uU(5),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.MGl("src","assets/defender_units/",e.unit,".png",t.LSH),t.xp6(1),t.hij(" (",e.newHp,") "),t.xp6(2),t.hij("(-",e.preservedHp||e.hp,")")}}function zt(n,a){if(1&n&&(t.TgZ(0,"div",14)(1,"ion-thumbnail",15),t._UZ(2,"img",16),t.qZA(),t._uU(3),t.TgZ(4,"ion-note"),t._uU(5,"(untouched)"),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.MGl("src","assets/defender_units/",e.unit,".png",t.LSH),t.xp6(1),t.hij(" (",e.hp,") ")}}function Jt(n,a){if(1&n&&(t.TgZ(0,"div",11)(1,"div",12),t.YNc(2,Rt,6,3,"div",13),t.YNc(3,St,6,3,"div",13),t.YNc(4,qt,6,2,"div",13),t.qZA(),t.TgZ(5,"div",12),t.YNc(6,Nt,6,3,"div",13),t.YNc(7,It,6,3,"div",13),t.YNc(8,zt,6,2,"div",13),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.battleResultStatistics.attackerSurvivors),t.xp6(1),t.Q6J("ngForOf",e.battleResultStatistics.attackersKilled),t.xp6(1),t.Q6J("ngForOf",e.battleResultStatistics.unusedAttackerUnits),t.xp6(2),t.Q6J("ngForOf",e.battleResultStatistics.defenderSurvivors),t.xp6(1),t.Q6J("ngForOf",e.battleResultStatistics.defendersKilled),t.xp6(1),t.Q6J("ngForOf",e.battleResultStatistics.untouchedDefenderUnits)}}let Q=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-battle-result-mini"]],inputs:{battleResultStatistics:"battleResultStatistics",isInvalid:"isInvalid",isExecutingBattleMatches:"isExecutingBattleMatches"},decls:11,vars:3,consts:[[1,"drag-line"],[1,"fight-result-text"],[1,"swords-icon"],["src","assets/other/BigSwords.png"],["color","danger","class","invalid-text",4,"ngIf"],["class","loading-message",4,"ngIf"],["class","two-column",4,"ngIf"],["color","danger",1,"invalid-text"],["name","alert-circle-outline"],[1,"loading-message"],["color","success","name","lines"],[1,"two-column"],[2,"width","50%"],["class","summary-unit-block",4,"ngFor","ngForOf"],[1,"summary-unit-block"],[1,"unit-image"],[3,"src"],["color","danger"]],template:function(e,o){1&e&&(t._UZ(0,"span",0),t.TgZ(1,"ion-text")(2,"h2",1)(3,"ion-thumbnail",2),t._UZ(4,"img",3),t.qZA(),t._uU(5," Fight Result "),t.TgZ(6,"ion-thumbnail",2),t._UZ(7,"img",3),t.qZA()()(),t.YNc(8,Bt,3,0,"ion-text",4),t.YNc(9,Dt,6,0,"div",5),t.YNc(10,Jt,9,6,"div",6)),2&e&&(t.xp6(8),t.Q6J("ngIf",o.isInvalid&&!o.isExecutingBattleMatches),t.xp6(1),t.Q6J("ngIf",o.isExecutingBattleMatches),t.xp6(1),t.Q6J("ngIf",!o.isExecutingBattleMatches&&o.battleResultStatistics))},dependencies:[m.sg,m.O5,r.gu,r.uN,r.PQ,r.yW,r.Bs],styles:["[_nghost-%COMP%]{display:block}.fight-result-text[_ngcontent-%COMP%]{font-size:20px}.swords-icon[_ngcontent-%COMP%]{display:inline-block;width:15px;height:15px;vertical-align:top;margin:0 15px}.two-column[_ngcontent-%COMP%]{display:flex;text-align:left;margin-top:15px;padding-bottom:20px}.two-column[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{border-right:1px solid #dedddd}.unit-image[_ngcontent-%COMP%]{width:35px;height:35px;display:inline-block;vertical-align:middle;margin-left:20px}.unit-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:contain;object-fit:contain}.summary-unit-block[_ngcontent-%COMP%]{display:inline-block;padding:0 10px;font-size:16px;font-weight:700;letter-spacing:1.2px}.summary-unit-block[_ngcontent-%COMP%]   .unit-image[_ngcontent-%COMP%]{margin-left:0}.drag-line[_ngcontent-%COMP%]{display:block;width:100px;height:3px;background:#d6d2d2;border-radius:10px;margin:5px auto 0}.invalid-text[_ngcontent-%COMP%]{font-size:15px;margin-bottom:20px;display:inline-block}.invalid-text[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{vertical-align:middle}.loading-message[_ngcontent-%COMP%]{margin-top:50px}.loading-message[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{width:40px;height:40px}@media (prefers-color-scheme: dark){[_nghost-%COMP%]{background-color:#292929;color:var(--ion-text-color)}.drag-line[_ngcontent-%COMP%]{background:#424242}.two-column[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{border-right:1px solid #424242}}"]}),n})();const Ht=function(){return{header:"Select Unit"}};let Y=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-donate-button"]],decls:55,vars:3,consts:[[1,"currency-select"],["interface","action-sheet","value","Q2Z5D48F4YMXL",3,"interfaceOptions"],["select",""],["value","52CNVTXALEQXL"],["value","P4Z2NJR2QRMQJ"],["value","YL3YTLC7QWREJ"],["value","UJX3JEYNVPZ4W"],["value","TYGY99HRPWJ4A"],["value","3YP34QNUFWA6Q"],["value","KCCND26B7RZ2E"],["value","WK6FFCMNAMENQ"],["value","L69898APZD5HU"],["value","UXGG6LV6UMTA8"],["value","XR2YFSVCDUMSC"],["value","Y2LW58MN7MYBY"],["value","FMABDARCXQFCJ"],["value","XDHWYJWRUPEC8"],["value","HJSHMTDBF5Z5A"],["value","TBE58BFGVVVLN"],["value","JBUWFSGNLEYVY"],["value","LAQXFNFMJ8U9S"],["value","EDX9FZXEFQYGY"],["value","QR4M289JUZ4SU"],["value","44CPPATC3T8HC"],["value","U5B3VTYBQKQM8"],["value","Q2Z5D48F4YMXL"],["ngNoForm","","action","https://www.paypal.com/donate","method","post","target","_top",1,"paypal-form"],["type","hidden","name","hosted_button_id",3,"value"],["type","image","src","https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif","border","0","name","submit","title","PayPal - The safer, easier way to pay online!","alt","Donate with PayPal button"],["alt","","border","0","src","https://www.paypal.com/en_US/i/scr/pixel.gif","width","1","height","1"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"ion-label"),t._uU(2,"Select currency:"),t.qZA(),t.TgZ(3,"ion-select",1,2)(5,"ion-select-option",3),t._uU(6,"AUD $"),t.qZA(),t.TgZ(7,"ion-select-option",4),t._uU(8,"BRL R$"),t.qZA(),t.TgZ(9,"ion-select-option",5),t._uU(10,"CAD $"),t.qZA(),t.TgZ(11,"ion-select-option",6),t._uU(12,"CHF Fr."),t.qZA(),t.TgZ(13,"ion-select-option",7),t._uU(14,"CZK K\u010d"),t.qZA(),t.TgZ(15,"ion-select-option",8),t._uU(16,"DKK kr."),t.qZA(),t.TgZ(17,"ion-select-option",9),t._uU(18,"EUR \u20ac"),t.qZA(),t.TgZ(19,"ion-select-option",10),t._uU(20,"GBP \xa3"),t.qZA(),t.TgZ(21,"ion-select-option",11),t._uU(22,"HKD $"),t.qZA(),t.TgZ(23,"ion-select-option",12),t._uU(24,"HUF Ft"),t.qZA(),t.TgZ(25,"ion-select-option",13),t._uU(26,"ILS \u20aa"),t.qZA(),t.TgZ(27,"ion-select-option",14),t._uU(28,"JPY \u200e\xa5\u200e"),t.qZA(),t.TgZ(29,"ion-select-option",15),t._uU(30,"\u200eMXN $\u200e"),t.qZA(),t.TgZ(31,"ion-select-option",16),t._uU(32,"NOK kr"),t.qZA(),t.TgZ(33,"ion-select-option",17),t._uU(34,"NZD $"),t.qZA(),t.TgZ(35,"ion-select-option",18),t._uU(36,"\u200ePHP \u20b1"),t.qZA(),t.TgZ(37,"ion-select-option",19),t._uU(38,"PLN gr"),t.qZA(),t.TgZ(39,"ion-select-option",20),t._uU(40,"RUB \u20bd"),t.qZA(),t.TgZ(41,"ion-select-option",21),t._uU(42,"SEK kr"),t.qZA(),t.TgZ(43,"ion-select-option",22),t._uU(44,"SGD $"),t.qZA(),t.TgZ(45,"ion-select-option",23),t._uU(46,"THB \u0e3f"),t.qZA(),t.TgZ(47,"ion-select-option",24),t._uU(48,"TWD $"),t.qZA(),t.TgZ(49,"ion-select-option",25),t._uU(50,"USD $"),t.qZA()()(),t.TgZ(51,"form",26),t._UZ(52,"input",27)(53,"input",28)(54,"img",29),t.qZA()),2&e){const i=t.MAs(4);t.xp6(3),t.Q6J("interfaceOptions",t.DdM(2,Ht)),t.xp6(49),t.Q6J("value",i.value)}},dependencies:[r.Q$,r.t9,r.n0,r.QI],styles:[".currency-select[_ngcontent-%COMP%]{width:230px;margin:auto}.currency-select[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{vertical-align:middle;display:inline-flex}"]}),n})();function Qt(n,a){if(1&n&&t._UZ(0,"app-battle-result-mini",3),2&n){const e=t.oxw();t.Q6J("battleResultStatistics",e.battleResultStatistics)}}function Yt(n,a){if(1&n&&t._UZ(0,"app-battle-result",4),2&n){const e=t.oxw();t.Q6J("multi",e.multi)("battleResults",e.battleResults)("battleResultStatistics",e.battleResultStatistics)("showingOptimalResult",e.showingOptimalResult)}}let Et=(()=>{class n{constructor(e){this.modalCtrl=e}ngOnInit(){}dismiss(){this.modalCtrl.dismiss()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(r.IN))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-br-modal"]],inputs:{battleResults:"battleResults",battleResultStatistics:"battleResultStatistics",multi:"multi",showingOptimalResult:"showingOptimalResult"},decls:10,vars:2,consts:[[3,"battleResultStatistics",4,"ngIf"],[3,"multi","battleResults","battleResultStatistics","showingOptimalResult",4,"ngIf"],[1,"close-button",3,"click"],[3,"battleResultStatistics"],[3,"multi","battleResults","battleResultStatistics","showingOptimalResult"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header"),t.YNc(1,Qt,1,1,"app-battle-result-mini",0),t.qZA(),t.TgZ(2,"ion-content"),t.YNc(3,Yt,1,4,"app-battle-result",1),t._UZ(4,"br")(5,"br")(6,"app-donate-button")(7,"br"),t.TgZ(8,"ion-button",2),t.NdJ("click",function(){return o.dismiss()}),t._uU(9,"Close"),t.qZA()()),2&e&&(t.xp6(1),t.Q6J("ngIf",o.battleResultStatistics),t.xp6(2),t.Q6J("ngIf",o.battleResults))},dependencies:[m.O5,r.YG,r.W2,r.Gu,Ft,Q,Y],styles:[".close-button[_ngcontent-%COMP%]{position:absolute;bottom:20px;right:15px;width:150px;text-align:center;width:100px;padding:6px;--border-radius: 4px}"]}),n})();var Gt=u(2150);let $t=(()=>{class n{constructor(e,o){this.fb=e,this.googleAnalytics=o,this.attackerUnits=d.in,this.defenderUnits=d.ac,this.landUnits=d.s2,this.resultChange=new t.vpe,this.onDestroy$=new M.xQ}ngOnInit(){const e=this.attackerUnits[0],i=this.defenderUnits[0],s=_.Z[i],l=this.landUnits[0];this.oneOnOneForm=this.fb.group({attacker:this.fb.group({unit:e,carriedUnit:l,hp:[_.Z[e].hp,[c.kI.required,c.kI.min(0)]],isVeteran:!1,isBoosted:!1,freeFromRetaliation:!1},{validators:[y,w]}),defender:this.fb.group({unit:i,carriedUnit:l,hp:[s.hp,[c.kI.required,c.kI.min(0)]],isVeteran:!1,isPoisoned:!1,withDefenseBonus:!1,withWallBonus:!1},{validators:[y,w]})}),this.oneOnOneForm.valueChanges.pipe((0,F.O)(this.oneOnOneForm.value),B(300),k(this.onDestroy$)).subscribe(()=>{this.showBattleResult()})}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}showBattleResult(){var e=this;return(0,T.Z)(function*(){if(!e.oneOnOneForm.valid)return e.battleResult=null,e.battleResultStatistics=null,void e.resultChange.emit({battleResults:[],battleResultStatistics:null,isInvalid:!0});const o=e.oneOnOneForm.get("attacker").value,i=e.oneOnOneForm.get("defender").value,{attackDamage:s,defenseDamage:l,defenderNewHp:g,attackerNewHp:p,splashedNewHp:h}=(0,Gt.g)(o,i);o.origHp=o.hp,o.newHp=p,o.attackDamage=Math.min(s,i.hp-g),i.origHp=i.hp,i.newHp=g,i.splashedNewHp=h,i.defenseDamage=Math.min(l,o.hp-p),e.battleResult={attacker:o,defender:i},e.battleResultStatistics={attackerSurvivors:[o],defenderSurvivors:[i],defendersKilled:[],attackersKilled:[],unusedAttackerUnits:[],untouchedDefenderUnits:[],totalAttackDamage:o.attackDamage,totalDefenseDamage:i.defenseDamage},e.resultChange.emit({battleResults:[e.battleResult],battleResultStatistics:e.battleResultStatistics,isInvalid:!1}),e.googleAnalytics.emitEvent("one-on-one calculate","method",`${o.unit} vs ${i.unit}`,{attacker:o,defender:i},1)})()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.QS),t.Y36(z))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-one-on-one"]],outputs:{resultChange:"resultChange"},decls:11,vars:1,consts:[[3,"formGroup"],["formGroupName","attacker","unitFormType","attacker"],["formGroupName","defender","unitFormType","defender"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0)(1,"ion-list")(2,"ion-item-divider")(3,"ion-title"),t._uU(4,"Offense Unit"),t.qZA()(),t._UZ(5,"app-unit-form",1),t.qZA(),t.TgZ(6,"ion-list")(7,"ion-item-divider")(8,"ion-title"),t._uU(9,"Defense Unit"),t.qZA()(),t._UZ(10,"app-unit-form",2),t.qZA()()),2&e&&t.Q6J("formGroup",o.oneOnOneForm)},dependencies:[r.rH,r.q_,r.wd,c._Y,c.JL,c.sg,c.x0,H],styles:["[_nghost-%COMP%]{display:flex;width:100%;flex-direction:column}ion-list[_ngcontent-%COMP%]{padding:0;margin-top:20px}app-battle-result[_ngcontent-%COMP%]{flex:1;display:block;margin-top:30px;margin-bottom:20px}.paypal-form[_ngcontent-%COMP%]{display:block}ion-title[_ngcontent-%COMP%]{color:var(--ion-text-color)}form[_ngcontent-%COMP%]{width:100%;min-height:700px}@media (min-width: 768px){form[_ngcontent-%COMP%]{display:flex;align-items:flex-start}ion-list[_ngcontent-%COMP%]{flex:1}ion-list[_ngcontent-%COMP%]:first-child{margin:20px 5px}}"]}),n})();const P={wa:"Warrior",ri:"Rider",ar:"Archer",de:"Defender",kn:"Knight",sw:"Swordsman",ca:"Catapult",gi:"Giant",cr:"Crab",tr:"Tridention",po:"Polytaur",na:"Navalon",ga:"Gaami",mb:"Mind Bender",eg:"Dragon Egg",bd:"Baby Dragon",dr:"Fire Dragon",mo:"Mooni",sl:"Battle Sled",if:"Ice Fortress",ia:"Ice Archer",sm:"Shaman",he:"Hexapod",ki:"Kiton",ph:"Phychi",ex:"Exida",ra:"Raychi",do:"Doomux",ce:"Centipede",se:"Segment",da:"Dagger",cl:"Cloak"},C={bo:"Boat",sh:"Ship",bs:"Battleship"},E={p:"Poisoned",b:"Boosted",v:"Veteran",d:"1.5x Def bonus ",w:"4x Def bonus (City Wall)"};var Vt=u(1481);const jt=["textareaHighlighter"];function Wt(n,a){if(1&n&&(t.TgZ(0,"ion-text",8),t._UZ(1,"ion-icon",9),t._uU(2),t.qZA()),2&n){const e=t.oxw();t.xp6(2),t.hij(" ",e.errorMessage," ")}}function Lt(n,a){1&n&&(t.TgZ(0,"ion-text",10),t._UZ(1,"ion-icon",11),t._uU(2," Hit enter to set defender unit."),t._UZ(3,"br"),t._uU(4," Format: "),t.TgZ(5,"mark",12),t._uU(6,"unit"),t.qZA(),t._uU(7," hp\xa0"),t.TgZ(8,"mark",13),t._uU(9,"modifier"),t.qZA()())}function Kt(n,a){if(1&n&&(t.TgZ(0,"ion-item")(1,"mark"),t._uU(2),t.qZA(),t._uU(3),t.qZA()),2&n){const e=a.$implicit;t.xp6(2),t.Oqu(e[0]),t.xp6(1),t.hij(" ",e[1],"")}}function Xt(n,a){if(1&n&&(t.TgZ(0,"ion-item")(1,"mark",13),t._uU(2),t.qZA(),t._uU(3),t.qZA()),2&n){const e=a.$implicit;t.xp6(2),t.Oqu(e[0]),t.xp6(1),t.hij(" ",e[1],"")}}let te=(()=>{class n{constructor(e,o,i){this.fb=e,this.cdr=o,this.sanitizer=i,this.resultChange=new t.vpe,this.unitsByCode=Object.entries(P).concat(Object.entries(C)),this.modifiersByCode=Object.entries(E),this.onDestroy$=new M.xQ}ngOnInit(){this.codeForm=this.fb.group({code:"",getOptimalResult:!1}),this.codeForm.valueChanges.pipe((0,F.O)(this.codeForm.value),B(300),k(this.onDestroy$),(0,N.w)(()=>this.showBattleResults())).subscribe(({battleResults:e=[],battleResultStatistics:o,isInvalid:i})=>{const s=this.codeForm.get("getOptimalResult").value;this.resultChange.emit({battleResults:e,battleResultStatistics:o,showingOptimalResult:s,isInvalid:i}),this.cdr.detectChanges()}),this.codeForm.get("code").valueChanges.pipe(k(this.onDestroy$)).subscribe(e=>{let o=e||"";Object.keys(P).concat(Object.keys(C)).forEach(i=>{o=o.replaceAll(`${i}`,`<xx>${i} </xx>`)}),Object.keys(E).forEach(i=>{o=o.replaceAll(` ${i}`,`<x> ${i}</x>`),o=o.replaceAll(`${i} `,`<x>${i} </x>`)}),o=o.replaceAll("<x>",'<mark class="modifier">'),o=o.replaceAll("</x>","</mark>"),o=o.replaceAll("<xx>",'<mark class="unit">'),o=o.replaceAll("</xx>","</mark>"),o=o.replaceAll("\n","<br />"),this.highlightedText=this.sanitizer.bypassSecurityTrustHtml(o)})}parseAttackers(e){return e.map(i=>{let s,l,g,p;const h=i.split(" ").map(f=>f.trim());h.forEach(f=>{C[f]&&(p=C[f]);const b=P[f];b&&d.in.includes(b)?s=b:b&&!d.in.includes(b)&&(this.errorMessage=`Attacker: ${s} cannot be an attacker`),Number.isInteger(parseInt(f))&&(l=parseInt(f))});const Z=h.includes("v"),v=h.includes("b"),R=h.includes("nr");if(p&&!d.s2.includes(s))return this.errorMessage=`Attacker: ${p} cannot carry ${s||"nothing"}`,null;if(p&&d.s2.includes(s)&&(g=s,s=p),!s||!l)return null;const U={unit:s,carriedUnit:g,hp:l,isVeteran:Z,isBoosted:v,freeFromRetaliation:R},O=(0,A.n)(U);return l>O?(this.errorMessage=`Attacker: ${s} exceeds max hp: ${O}`,null):U}).filter(i=>null!==i)}parseDefenders(e){return e.map(i=>{let s,l,g,p;const h=i.split(" ").map(f=>f.trim());h.forEach(f=>{C[f]&&(p=C[f]);const b=P[f];b&&d.ac.includes(b)?s=b:b&&!d.ac.includes(b)&&(this.errorMessage=`Defender: ${s} cannot be a defender`),Number.isInteger(parseInt(f))&&(l=parseInt(f))});const Z=h.includes("v");let v;h.includes("w")?v="withWall":h.includes("d")&&(v="withoutWall");const R=h.includes("p");if(p&&!d.s2.includes(s))return this.errorMessage=`Defender: ${p} cannot carry ${s||"nothing"}`,null;if(p&&d.s2.includes(s)&&(g=s,s=p),!s||!l)return null;const U={unit:s,carriedUnit:g,hp:l,isVeteran:Z,withDefenseBonus:v,isPoisoned:R,freeFromRetaliation:!1},O=(0,A.n)(U);return l>O?(this.errorMessage=`Defender: ${s} exceeds max hp: ${O}`,null):U}).filter(i=>null!==i)}showBattleResults(){return new q.y(e=>{const o=this.codeForm.get("code").value||"",[i,s]=o.split("\n");if(!i||!s)return e.next({isInvalid:!0}),void e.complete();const l=this.parseAttackers(i.split(",")),g=this.parseDefenders(s.split(","));if(l.length<=0||g.length<=0)return e.next({isInvalid:!0}),void e.complete();this.errorMessage="";const p=this.codeForm.get("getOptimalResult").value;if(typeof Worker<"u"){const h=new Worker(u.tu(new URL(u.p+u.u(4584),u.b)),{type:void 0});return h.onmessage=({data:Z})=>{e.next(Z),e.complete(),h.terminate()},h.postMessage({attackers:l,defenders:g,getOptimalResult:p}),{unsubscribe:()=>{e.complete(),h.terminate()}}}e.next((0,I.M_)(l,g,p)),e.complete()})}toggleGetOptimalResult(){const e=this.codeForm.get("getOptimalResult").value;this.codeForm.get("getOptimalResult").setValue(!e)}ngOnDestroy(){this.onDestroy$.next(),this.onDestroy$.complete()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.QS),t.Y36(t.sBO),t.Y36(Vt.H7))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-code"]],viewQuery:function(e,o){if(1&e&&t.Gf(jt,7),2&e){let i;t.iGM(i=t.CRH())&&(o.textAreaHighlighter=i.first)}},outputs:{resultChange:"resultChange"},decls:27,vars:6,consts:[[3,"formGroup"],["formControlName","code","placeholder","wa 10, he 5 b \n de 15"],[1,"textarea-highlighter",3,"innerHTML"],["textareaHighlighter",""],["color","danger","class","invalid-text",4,"ngIf"],["color","medium","class","code-instruction",4,"ngIf"],[1,"two-column-wrapper"],[4,"ngFor","ngForOf"],["color","danger",1,"invalid-text"],["name","alert-circle-outline"],["color","medium",1,"code-instruction"],["name","information-circle-outline"],[1,"unit"],[1,"modifier"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0)(1,"ion-list")(2,"ion-item-divider")(3,"ion-title"),t._uU(4,"Type codes to calculate"),t.qZA()(),t.TgZ(5,"ion-item-group")(6,"ion-item")(7,"ion-label"),t._uU(8,"Attacker: "),t._UZ(9,"br"),t._uU(10," Defender: "),t.qZA(),t._UZ(11,"ion-textarea",1)(12,"div",2,3),t.qZA()()(),t.YNc(14,Wt,3,1,"ion-text",4),t.YNc(15,Lt,10,0,"ion-text",5),t.qZA(),t.TgZ(16,"div",6)(17,"ion-list")(18,"ion-item-divider")(19,"ion-title"),t._uU(20,"Units"),t.qZA()(),t.YNc(21,Kt,4,2,"ion-item",7),t.qZA(),t.TgZ(22,"ion-list")(23,"ion-item-divider")(24,"ion-title"),t._uU(25,"Modifiers"),t.qZA()(),t.YNc(26,Xt,4,2,"ion-item",7),t.qZA()()),2&e&&(t.Q6J("formGroup",o.codeForm),t.xp6(12),t.Q6J("innerHTML",o.highlightedText,t.oJD),t.xp6(2),t.Q6J("ngIf",o.errorMessage),t.xp6(1),t.Q6J("ngIf",!o.errorMessage),t.xp6(6),t.Q6J("ngForOf",o.unitsByCode),t.xp6(5),t.Q6J("ngForOf",o.modifiersByCode))},dependencies:[m.sg,m.O5,r.gu,r.Ie,r.rH,r.Ub,r.Q$,r.q_,r.yW,r.g2,r.wd,r.j9,c._Y,c.JJ,c.JL,c.sg,c.u],styles:["[_nghost-%COMP%]{display:flex;width:100%;flex-direction:column}ion-list[_ngcontent-%COMP%]{padding:0;margin-top:20px}ion-title[_ngcontent-%COMP%]{color:var(--ion-text-color);margin-bottom:12px}ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:#666;color:var(--ion-color-step-600, #666666)}.optimal-result-block[_ngcontent-%COMP%]{text-align:left;margin-top:20px}.optimal-result-block[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{vertical-align:middle;margin-left:6px;font-size:15px;text-indent:0;display:inline-block}.invalid-text[_ngcontent-%COMP%]{font-size:15px;display:inline-block}.invalid-text[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{vertical-align:middle}.two-column-wrapper[_ngcontent-%COMP%]{display:flex;align-items:flex-start}.two-column-wrapper[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{flex:1}.two-column-wrapper[_ngcontent-%COMP%]   mark[_ngcontent-%COMP%]{background-color:var(--ion-color-success-tint);padding:0 6px;border-radius:4px;display:inline-block;margin-right:8px}.two-column-wrapper[_ngcontent-%COMP%]   mark.modifier[_ngcontent-%COMP%]{background-color:var(--ion-color-primary-tint)}ion-textarea[_ngcontent-%COMP%]{position:relative;z-index:0}.code-instruction[_ngcontent-%COMP%], .invalid-text[_ngcontent-%COMP%]{margin-block:10px;display:block}[_nghost-%COMP%]     .textarea-highlighter{position:absolute;left:76px;top:18px;z-index:1;pointer-events:0}[_nghost-%COMP%]     .textarea-highlighter mark, [_nghost-%COMP%]     .code-instruction mark{background:none}[_nghost-%COMP%]     .textarea-highlighter mark.unit, [_nghost-%COMP%]     .code-instruction mark.unit{color:var(--ion-color-success-tint)}[_nghost-%COMP%]     .textarea-highlighter mark.modifier, [_nghost-%COMP%]     .code-instruction mark.modifier{color:var(--ion-color-primary-tint)}"]}),n})();const ee=["Arthur Lejars","Jason Flick","Luca Accomazzi","Spencer Renfro"];function ne(n,a){if(1&n&&(t.TgZ(0,"ion-item")(1,"ion-label"),t._uU(2),t.qZA()()),2&n){const e=a.$implicit;t.xp6(2),t.Oqu(e)}}let oe=(()=>{class n{constructor(){this.donors=ee}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-about"]],decls:23,vars:1,consts:[["name","heart",2,"color","red"],[2,"max-height","420px","overflow-y","auto"],["lines","none"],[4,"ngFor","ngForOf"],["href","https://discordapp.com/users/692361022190780436"]],template:function(e,o){1&e&&(t._UZ(0,"br"),t.TgZ(1,"ion-title"),t._uU(2,"Thanks for donating "),t._UZ(3,"ion-icon",0),t.qZA(),t.TgZ(4,"div",1)(5,"ion-list",2),t.YNc(6,ne,3,1,"ion-item",3),t.qZA()(),t._UZ(7,"br"),t.TgZ(8,"ion-title"),t._uU(9,"Creator"),t.qZA(),t.TgZ(10,"ion-list",2)(11,"ion-item")(12,"ion-label")(13,"a",4),t._uU(14,"NarelTheDev"),t.qZA()()()(),t._UZ(15,"br"),t.TgZ(16,"ion-note"),t._uU(17,"Calculation logic updated as of v2.2.9.8251 "),t._UZ(18,"br"),t._uU(19,' of the actual game "The Battle of Polytopia".'),t.qZA(),t._UZ(20,"br")(21,"br")(22,"app-donate-button")),2&e&&(t.xp6(6),t.Q6J("ngForOf",o.donors))},dependencies:[m.sg,r.gu,r.Ie,r.Q$,r.q_,r.uN,r.wd,Y],styles:["[_nghost-%COMP%]{display:block;width:100%}ion-title[_ngcontent-%COMP%]{margin-bottom:10px}"]}),n})();const ie=["ionContent"],ae=["ionSlides"],se=["ionSegment"],re=["battle"];function ce(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"ion-footer")(1,"app-battle-result-mini",15),t.NdJ("touchstart",function(i){t.CHM(e);const s=t.oxw();return t.KtG(!s.isExecutingBattleMatches&&s.showBattleResultModal(i))})("mousedown",function(i){t.CHM(e);const s=t.oxw();return t.KtG(!s.isExecutingBattleMatches&&s.showBattleResultModal(i))}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("isInvalid",e.resultData.isInvalid)("isExecutingBattleMatches",e.isExecutingBattleMatches)("battleResultStatistics",e.resultData.battleResultStatistics)}}let le=(()=>{class n{constructor(e,o,i){this.cdr=e,this.modalController=o,this.elRef=i,this.activeSlideIndex=0,this.slideOpts={allowTouchMove:!1,autoHeight:!0}}ngOnInit(){}ngAfterViewInit(){}onOneOnOneChange(e){this.oneOnOneData=e}onBattleChange(e){this.battleData=e}onCodeChange(e){this.codeData=e}scrollToBattleResult(){if(this.isOneOnOne)this.ionContent.scrollToBottom(100);else{const e=this.elRef.nativeElement.querySelector("app-battle .optimal-result-block");e&&e.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}}get isExecutingBattleMatches(){return!this.isOneOnOne&&this.battleComponent.isExecutingBattleMatches}get isOneOnOne(){return 1===this.activeSlideIndex}get isBattle(){return 2===this.activeSlideIndex}get isCode(){return 0===this.activeSlideIndex}get resultData(){return this.isOneOnOne?this.oneOnOneData||{}:this.isBattle?this.battleData||{}:this.isCode&&this.codeData||{}}onSlideChange(){var e=this;return(0,T.Z)(function*(){e.activeSlideIndex=yield e.ionSlides.getActiveIndex()})()}showBattleResultModal(e){var o=this;return(0,T.Z)(function*(){if(e.preventDefault(),e.stopPropagation(),o.isShowingModalInProgress||o.resultData.isInvalid)return;o.isShowingModalInProgress=!0;const i=o.resultData;o.isOneOnOne||(i.multi=!0),o.modal=yield o.modalController.create({component:Et,cssClass:"br-modal",mode:"ios",componentProps:i,swipeToClose:!0,showBackdrop:!0,backdropDismiss:!0}),yield o.modal.present(),o.isShowingModalInProgress=!1})()}onSegmentChange(e){this.ionSlides.slideTo(e.detail.value)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO),t.Y36(r.IN),t.Y36(t.SBq))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-battle-calculator"]],viewQuery:function(e,o){if(1&e&&(t.Gf(ie,7),t.Gf(ae,7),t.Gf(se,7),t.Gf(re,7)),2&e){let i;t.iGM(i=t.CRH())&&(o.ionContent=i.first),t.iGM(i=t.CRH())&&(o.ionSlides=i.first),t.iGM(i=t.CRH())&&(o.ionSegment=i.first),t.iGM(i=t.CRH())&&(o.battleComponent=i.first)}},decls:30,vars:5,consts:[["slot","start"],["slot","end",1,"mode-toggle",3,"value","scrollable","ionChange"],["ionSegment",""],["value","0"],["value","1"],["value","2"],["value","3","layout","label-hide"],["name","heart",2,"color","red"],[3,"scrollEvents"],["ionContent",""],[3,"options","ionSlideWillChange"],["ionSlides",""],[3,"resultChange"],["battle",""],[4,"ngIf"],["tappable","",1,"battle-result-sticky",3,"isInvalid","isExecutingBattleMatches","battleResultStatistics","touchstart","mousedown"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title",0),t._uU(3,"Polytopia"),t._UZ(4,"br"),t._uU(5,"Calculator"),t.qZA(),t.TgZ(6,"ion-segment",1,2),t.NdJ("ionChange",function(s){return o.onSegmentChange(s)}),t.TgZ(8,"ion-segment-button",3),t._uU(9," Code "),t.qZA(),t.TgZ(10,"ion-segment-button",4),t._uU(11," Simple "),t.qZA(),t.TgZ(12,"ion-segment-button",5),t._uU(13," Battle "),t.qZA(),t.TgZ(14,"ion-segment-button",6),t._UZ(15,"ion-icon",7),t.qZA()()()(),t.TgZ(16,"ion-content",8,9)(18,"ion-slides",10,11),t.NdJ("ionSlideWillChange",function(){return o.onSlideChange()}),t.TgZ(20,"ion-slide")(21,"app-code",12),t.NdJ("resultChange",function(s){return o.onCodeChange(s)}),t.qZA()(),t.TgZ(22,"ion-slide")(23,"app-one-on-one",12),t.NdJ("resultChange",function(s){return o.onOneOnOneChange(s)}),t.qZA()(),t.TgZ(24,"ion-slide")(25,"app-battle",12,13),t.NdJ("resultChange",function(s){return o.onBattleChange(s)}),t.qZA()(),t.TgZ(27,"ion-slide"),t._UZ(28,"app-about"),t.qZA()()(),t.YNc(29,ce,2,3,"ion-footer",14)),2&e&&(t.xp6(6),t.Q6J("value",o.activeSlideIndex)("scrollable",!0),t.xp6(10),t.Q6J("scrollEvents",!0),t.xp6(2),t.Q6J("options",o.slideOpts),t.xp6(11),t.Q6J("ngIf",o.resultData.battleResults))},dependencies:[m.O5,r.W2,r.fr,r.Gu,r.gu,r.cJ,r.GO,r.A$,r.Hr,r.wd,r.sr,r.QI,Q,$t,Ot,te,oe],styles:[".mode-toggle[_ngcontent-%COMP%]{width:360px;margin:auto}.mode-toggle[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{align-items:center;--padding-start: 6px;--padding-end: 6px}.mode-toggle[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]::part(native){min-width:auto}ion-title[_ngcontent-%COMP%]{color:#e47b0c;font-size:20px;text-align:center;padding-left:16px}ion-title[_ngcontent-%COMP%]   br[_ngcontent-%COMP%]{display:none}@media (max-width: 500px){ion-title[_ngcontent-%COMP%]{font-size:18px;text-align:left;line-height:100%;padding-top:5px;padding-right:8px;padding-left:10px}ion-title[_ngcontent-%COMP%]   br[_ngcontent-%COMP%]{display:block}}.show-battle-result[_ngcontent-%COMP%]{margin-bottom:20px;margin-right:5px;opacity:.3}.show-battle-result[_ngcontent-%COMP%]   .swords-icon[_ngcontent-%COMP%]{width:30px;height:30px}ion-footer[_ngcontent-%COMP%]:before{display:none}.battle-result-sticky[_ngcontent-%COMP%]{width:100%;box-shadow:0 0 2px #bbb;border:1px solid #eaeaea;background-color:#fff;border-top-left-radius:15px;border-top-right-radius:15px}@media (prefers-color-scheme: dark){.battle-result-sticky[_ngcontent-%COMP%]{border:1px solid #292929;background-color:#292929;border-top-left-radius:15px;border-top-right-radius:15px;color:var(--ion-text-color)}}@media (min-width: 768px){.fab-scroll-toggle[_ngcontent-%COMP%]{display:none}}"]}),n})(),ue=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.ez,r.Pc,c.UX]}),n})();var de=u(4145);let pe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.ez,r.Pc,c.UX,ue,de.Bz.forChild([{path:"",component:le}])]}),n})()}}]);